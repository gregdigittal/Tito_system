<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd">

    <changeSet author="tito" id="payments-pool-account-type-insert">
        <comment>Phase 8-7: Pool account type for country-specific pool model. Idempotent: insert only if no Pool type exists.</comment>
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(*) FROM account_type WHERE name = 'Pool'</sqlCheck>
        </preConditions>
        <sql>
            INSERT INTO account_type (currency_id, name, description, active)
            SELECT c.id, 'Pool', 'Pool account for aggregation (Phase 8-7)', 1
            FROM currency c WHERE c.iso_code = 'MZN' LIMIT 1
        </sql>
    </changeSet>
</databaseChangeLog>
