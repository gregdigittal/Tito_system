spring:
  kafka:
    # Defaults allow app to start without Kafka (e.g. Render/Tito minimal deploy). Set KAFKA_PREFIX and KAFKA_BOOTSTRAP_SERVERS for real Kafka.
    bootstrap-servers: ${kafka.bootstrap-servers:localhost:9092}
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer
    consumer:
      auto-offset-reset: earliest
      key-deserializer: org.springframework.kafka.support.serializer.ErrorHandlingDeserializer
      value-deserializer: org.springframework.kafka.support.serializer.ErrorHandlingDeserializer
      properties:
        spring.deserializer.key.delegate.class: org.apache.kafka.common.serialization.StringDeserializer
        spring.deserializer.value.delegate.class: org.springframework.kafka.support.serializer.JsonDeserializer
        spring.json.trusted.packages: "cash.ice.common.dto,cash.ice.common.dto.fee,cash.ice.common.dto.zim"
ice:
  cash:
    kafka:
      retry-policy:
        back-off-type: exponentialWithMaxRetries           # exponentialWithMaxRetries(attempts,interval-ms,multiplier,max-interval-ms) / exponential(interval-ms,multiplier,max-interval-ms,max-elapsed-time-ms) / fixed(interval-ms,attempts)
        interval-ms: 300
        multiplier: 2.0
        attempts: 10
      topic:
        partitions: 1
        replicas: 1
        # Default kafka.prefix (tito) allows app to start without KAFKA_PREFIX set (e.g. Render minimal deploy)
        payment-request: ${kafka.prefix:tito}.payment.RequestTopic
        payment-request-dlt: ${kafka.prefix:tito}.payment.RequestTopic.DLT
        fee-service: ${kafka.prefix:tito}.payment.FeeServiceTopic
        fee-service-dlt: ${kafka.prefix:tito}.payment.FeeServiceTopic.DLT
        payment-selector: ${kafka.prefix:tito}.payment.SelectorTopic
        payment-selector-dlt: ${kafka.prefix:tito}.payment.SelectorTopic.DLT
        sub-payment-result: ${kafka.prefix:tito}.payment.SubResultTopic
        sub-payment-result-dlt: ${kafka.prefix:tito}.payment.SubResultTopic.DLT
        paygo-service: ${kafka.prefix:tito}.payment.PaygoServiceTopic
        paygo-service-dlt: ${kafka.prefix:tito}.payment.PaygoServiceTopic.DLT
        paygo-success-payment: ${kafka.prefix:tito}.payment.LedgerServiceTopic
        paygo-success-payment-dlt: ${kafka.prefix:tito}.payment.LedgerServiceTopic.DLT
        ecocash-service: ${kafka.prefix:tito}.payment.zim.EcocashServiceTopic
        ecocash-service-dlt: ${kafka.prefix:tito}.payment.zim.EcocashServiceTopic.DLT
        ecocash-success-payment: ${kafka.prefix:tito}.payment.LedgerServiceTopic
        ecocash-success-payment-dlt: ${kafka.prefix:tito}.payment.LedgerServiceTopic.DLT
        onemoney-service: ${kafka.prefix:tito}.payment.zim.OnemoneyServiceTopic
        onemoney-service-dlt: ${kafka.prefix:tito}.payment.zim.OnemoneyServiceTopic.DLT
        onemoney-success-payment: ${kafka.prefix:tito}.payment.LedgerServiceTopic
        onemoney-success-payment-dlt: ${kafka.prefix:tito}.payment.LedgerServiceTopic.DLT
        flexcube-ledger-service: ${kafka.prefix:tito}.payment.zim.FlexcubeLedgerServiceTopic
        flexcube-ledger-service-dlt: ${kafka.prefix:tito}.payment.zim.FlexcubeLedgerServiceTopic.DLT
        flexcube-ledger-success-payment: ${kafka.prefix:tito}.payment.zim.RtgsServiceTopic
        flexcube-ledger-success-payment-dlt: ${kafka.prefix:tito}.payment.zim.RtgsServiceTopic.DLT
        rtgs-service: ${kafka.prefix:tito}.payment.zim.RtgsServiceTopic
        rtgs-service-dlt: ${kafka.prefix:tito}.payment.zim.RtgsServiceTopic.DLT
        rtgs-success-payment: ${kafka.prefix:tito}.payment.SuccessTopic
        rtgs-success-payment-dlt: ${kafka.prefix:tito}.payment.SuccessTopic.DLT
        zipit-service: ${kafka.prefix:tito}.payment.ZipitServiceTopic
        zipit-service-dlt: ${kafka.prefix:tito}.payment.ZipitServiceTopic.DLT
        zipit-success-payment: ${kafka.prefix:tito}.payment.LedgerServiceTopic
        zipit-success-payment-dlt: ${kafka.prefix:tito}.payment.LedgerServiceTopic.DLT
        zim-switch-service: ${kafka.prefix:tito}.payment.ZimSwitchServiceTopic
        zim-switch-service-dlt: ${kafka.prefix:tito}.payment.ZimSwitchServiceTopic.DLT
        zim-switch-success-payment: ${kafka.prefix:tito}.payment.LedgerServiceTopic
        zim-switch-success-payment-dlt: ${kafka.prefix:tito}.payment.LedgerServiceTopic.DLT
        mpesa-service: ${kafka.prefix:tito}.payment.MpesaServiceTopic
        mpesa-service-dlt: ${kafka.prefix:tito}.payment.MpesaServiceTopic.DLT
        mpesa-success-payment: ${kafka.prefix:tito}.payment.LedgerServiceTopic
        mpesa-success-payment-dlt: ${kafka.prefix:tito}.payment.LedgerServiceTopic.DLT
        emola-service: ${kafka.prefix:tito}.payment.EmolaServiceTopic
        emola-service-dlt: ${kafka.prefix:tito}.payment.EmolaServiceTopic.DLT
        emola-success-payment: ${kafka.prefix:tito}.payment.LedgerServiceTopic
        emola-success-payment-dlt: ${kafka.prefix:tito}.payment.LedgerServiceTopic.DLT
        zim-payment-request: ${kafka.prefix:tito}.payment.zim.RequestTopic
        zim-payment-request-dlt: ${kafka.prefix:tito}.payment.zim.RequestTopic.DLT
        zim-payment-result: ${kafka.prefix:tito}.payment.zim.ResultTopic
        zim-payment-result-dlt: ${kafka.prefix:tito}.payment.zim.ResultTopic.DLT
        zim-payment-error: ${kafka.prefix:tito}.payment.zim.ErrorTopic
        zim-payment-error-dlt: ${kafka.prefix:tito}.payment.zim.ErrorTopic.DLT
        posb-service: ${kafka.prefix:tito}.payment.zim.PosbServiceTopic
        fbc-service: ${kafka.prefix:tito}.payment.zim.FbcServiceTopic
        fbc-service-dlt: ${kafka.prefix:tito}.payment.zim.FbcServiceTopic.DLT
        fcb-service: ${kafka.prefix:tito}.payment.zim.FcbServiceTopic
        fcb-service-dlt: ${kafka.prefix:tito}.payment.zim.FcbServiceTopic.DLT
        ledger-service: ${kafka.prefix:tito}.payment.LedgerServiceTopic
        ledger-service-dlt: ${kafka.prefix:tito}.payment.LedgerServiceTopic.DLT
        success-payment: ${kafka.prefix:tito}.payment.SuccessTopic
        success-payment-dlt: ${kafka.prefix:tito}.payment.SuccessTopic.DLT
        error-payment: ${kafka.prefix:tito}.payment.ErrorTopic
        error-payment-dlt: ${kafka.prefix:tito}.payment.ErrorTopic.DLT
        after-success-payment: ${kafka.prefix:tito}.payment.AfterSuccessTopic
        after-success-payment-dlt: ${kafka.prefix:tito}.payment.AfterSuccessTopic.DLT
        balance-audit: ${kafka.prefix:tito}.payment.BalanceAuditTopic
        balance-audit-dlt: ${kafka.prefix:tito}.payment.BalanceAuditTopic.DLT
        email-notification: ${kafka.prefix:tito}.communication.email
        email-notification-dlt: ${kafka.prefix:tito}.communication.email.DLT
        sms-notification: ${kafka.prefix:tito}.communication.sms
        sms-notification-dlt: ${kafka.prefix:tito}.communication.sms.DLT
        invalidate-cache: ${kafka.prefix:tito}.payment.InvalidateCache
---
spring.config.activate.on-profile: local,local-perf
kafka:
  bootstrap-servers: 127.0.0.1:29092
  prefix: local
ice.cash.kafka.retry-policy.attempts: 1
---
spring.config.activate.on-profile: local-docker
kafka:
  bootstrap-servers: kafka:29592
ice.cash.kafka.retry-policy.attempts: 1
